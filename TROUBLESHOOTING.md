# Решение проблем с OpenRouter API

## Ошибка 403 Forbidden

Если вы получаете ошибку **403 Forbidden** при запросах к OpenRouter API, выполните следующие шаги:

### 1. Проверьте формат API ключа

OpenRouter API ключ должен:
- Начинаться с `sk-or-v1-`
- Быть длиной примерно 50-60 символов
- Не содержать пробелов в начале или конце

**Правильный формат:**
```
OPENROUTER_API_KEY=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
```

### 2. Проверьте файл .env

1. Убедитесь, что файл `.env` находится в корне проекта
2. Проверьте, что ключ указан без кавычек:
   ```env
   OPENROUTER_API_KEY=sk-or-v1-ваш_ключ_здесь
   ```
3. Убедитесь, что нет лишних пробелов

### 3. Проверьте ключ на сайте OpenRouter

1. Зайдите на https://openrouter.ai/keys
2. Убедитесь, что ключ активен
3. Проверьте лимиты и баланс аккаунта

### 4. Проверьте доступность модели

Некоторые модели могут быть недоступны для вашего аккаунта:
- Проверьте список доступных моделей на https://openrouter.ai/models
- Убедитесь, что модель существует и доступна
- Некоторые модели требуют специальных прав доступа

### 5. Запустите тестовый скрипт

Запустите скрипт для проверки подключения:
```bash
python test_openrouter.py
```

Этот скрипт покажет детальную информацию об ошибке.

### 6. Проверьте логи

Посмотрите файл `chatlist.log` для детальной информации об ошибках:
```bash
cat chatlist.log
# или в Windows:
type chatlist.log
```

## Другие распространенные ошибки

### 401 Unauthorized
- Неверный API ключ
- Ключ истек или был отозван
- Решение: создайте новый ключ на https://openrouter.ai/keys

### 429 Too Many Requests
- Превышен лимит запросов
- Решение: подождите или увеличьте лимит в настройках аккаунта

### 400 Bad Request
- Неверный формат запроса
- Модель недоступна или не существует
- Решение: проверьте правильность `api_id` модели

## Получение нового API ключа

1. Зайдите на https://openrouter.ai/
2. Зарегистрируйтесь или войдите в аккаунт
3. Перейдите в раздел "Keys" (https://openrouter.ai/keys)
4. Создайте новый API ключ
5. Скопируйте ключ в файл `.env`

## Проверка работы API ключа

Используйте тестовый скрипт:
```bash
python test_openrouter.py
```

Если скрипт показывает успешный ответ, значит ключ работает правильно.

